@model IEnumerable<MiniReportsProject.Models.GranteeModel>

<div class="container-fluid mt-4">

    <!-- Main Card -->
    <div class="card shadow-sm border">

        <!-- Header -->
        <div class="card-header bg-white border-bottom">
            <h5 class="mb-0 fw-bold text-dark">State Home</h5>
        </div>

        <!-- Body -->
        <div class="card-body">

            <!-- Title -->
            <div class="row mb-4">
                <div class="col text-center">
                    <h3 class="fw-semibold text-dark">Grantees</h3>
                </div>
            </div>

            <!-- Add Grantee Button -->
            <div class="row mb-4">
                <div class="col">
                    <a href="@Url.Action("Create", "State")"
                       class="btn btn-outline-primary">
                        + Add Grantee
                    </a>
                </div>
            </div>

            <!-- Grantee List -->
            <div class="row align-items-center py-3 border-bottom" id="grantee-list">

                <!-- Grantee Name -->
                <!--<div class="col-md-8">
                    <span class="fs-5 text-dark" id="grantee-name-span">-->
                        @*→ @g.GranteeName*@
                    <!--</span>
                </div>-->

                <!--Action Button-->
                @*<div class="col-md-4 text-end">
                    <a href="@Url.Action("Index", "Grantee", new { ID = g.GranteeID })"
                       class="btn btn-success px-4"
                       onclick="storeGranteeID(@g.GranteeID, '@g.GranteeName')"
                       id="grantee-logon-Btn">
                        →
                    </a>
                </div>*@

            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        const storeGranteeID = (granteeID, granteeName) => {
            localStorage.setItem("GranteeID", granteeID);
            localStorage.setItem("GranteeName", granteeName);
            console.log("Stored GranteeID:", granteeID);
            console.log("Stored GranteeName:", granteeName);
        };

        function PopulateGranteeList(GranteeList) {
            $.each(GranteeList, function (ind, grantee) {
                $("#grantee-list").append(
                    `<div class="row align-items-center py-3 border-bottom">
                        <div class="col-md-8">
                            <span class="fs-5 text-dark" id="grantee-name-span">
                                → ${grantee.GranteeName}
                            </span>
                        </div>
                        <div class="col-md-4 text-end">
                            <a href="/Grantee/Index/${grantee.GranteeID}"
                               class="btn btn-success px-4"
                               onclick="storeGranteeID(${grantee.GranteeID}, '${grantee.GranteeName}')"
                               id="grantee-logon-Btn">
                                →
                            </a>
                        </div>
                    </div>`
                )
            })
        }

        function GetAllGrantees() {
            $.ajax({
                url: '/State/GetAllGrantees',
                type: 'GET',
                success: function (res) {
                    if (!res.success) {
                        alert(res.message || 'Failed to retrieve grantees.');
                        return;
                    }
                    PopulateGranteeList(res.data)
                },
                error: function (error) {
                    alert('Error retrieving grantees:', error);
                }
            })
        }

    </script>
}